<!DOCTYPE html>
<html lang="bg">
<head>
  <meta charset="utf-8">
  <title>–£—ä—Ä–¥—ä–ª –ë–ì</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="../../css/fonts.css">
  <link rel="stylesheet" href="../../css/normalize.css">
  <link rel="stylesheet" href="../../css/skeleton.css">
  <link rel="stylesheet" href="../../css/custom.css">
  <style>
    .panel { max-width: 380px; margin: 0 auto; text-align:center; }
    #grid { display:inline-grid; grid-template-rows:repeat(6,1fr); gap:6px; margin:12px 0; }
    .row { display:grid; grid-template-columns:repeat(5,1fr); gap:6px; }
    .tile { width:52px; height:52px; border:2px solid #ccc; border-radius:4px;
            display:flex; align-items:center; justify-content:center;
            font-size:1.6rem; font-weight:bold; text-transform:uppercase;
            transition:background .25s, border-color .25s, color .25s; }
    .tile.filled { border-color:#888; }
    .tile.correct { background:#27ae60; border-color:#27ae60; color:#fff; }
    .tile.present { background:#e67e22; border-color:#e67e22; color:#fff; }
    .tile.absent  { background:#95a5a6; border-color:#95a5a6; color:#fff; }
    #keyboard { display:flex; flex-direction:column; gap:6px; align-items:center; margin-bottom:12px; }
    .kb-row { display:flex; gap:4px; }
    .key { min-width:32px; height:42px; padding:0 6px; border:1px solid #ccc; border-radius:4px;
           background:#ecf0f1; font-size:.85rem; font-weight:bold; cursor:pointer;
           display:flex; align-items:center; justify-content:center; user-select:none;
           transition:background .2s, color .2s; }
    .key.correct { background:#27ae60; color:#fff; border-color:#27ae60; }
    .key.present { background:#e67e22; color:#fff; border-color:#e67e22; }
    .key.absent  { background:#bdc3c7; color:#fff; border-color:#bdc3c7; }
    .key.wide { min-width:52px; font-size:.75rem; }
    #msg { min-height:1.8rem; font-weight:bold; margin-bottom:6px; font-size:1rem; }
  </style>
</head>
<body>
  <div class="container">
    <div class="row" style="margin-top:2rem"><a href="../">‚Üê –ö—ä–º –∏–≥—Ä–∏—Ç–µ</a></div>
    <div class="row panel">
      <h4>–£—ä—Ä–¥—ä–ª –ë–ì</h4>
      <p style="color:#666;font-size:.85rem;margin-bottom:4px;">–ü–æ–∑–Ω–∞–π 5-–±—É–∫–≤–µ–Ω–∞—Ç–∞ –¥—É–º–∞ –∑–∞ 6 –æ–ø–∏—Ç–∞.<br>üü© –ø—Ä–∞–≤–∏–ª–Ω–∞ –ø–æ–∑–∏—Ü–∏—è ¬∑ üüß –≥—Ä–µ—à–Ω–∞ –ø–æ–∑–∏—Ü–∏—è ¬∑ ‚¨ú –Ω–µ –µ –≤ –¥—É–º–∞—Ç–∞</p>
      <div id="msg"></div>
      <div id="grid"></div>
      <div id="keyboard"></div>
      <button class="button" id="newBtn" style="width:100%">–ù–æ–≤–∞ –¥—É–º–∞</button>
    </div>
  </div>
<script>
'use strict';
const WORDS = [
  '–ú–ê–°–ö–ê','–ö–ù–ò–ì–ê','–°–õ–û–í–û','–ü–†–ê–í–ê','–¢–ê–ô–ù–ê','–ó–ï–õ–ï–ù','–ó–õ–ê–¢–û','–ö–ê–†–¢–ê','–ö–û–†–ê–ë','–ö–£–ö–õ–ê',
  '–õ–ï–ì–õ–û','–õ–ï–°–ù–û','–ú–ï–¢–õ–ê','–ú–ï–ß–¢–ê','–ú–õ–Ø–ö–û','–ú–†–ï–ñ–ê','–ù–ê–ß–ò–ù','–ù–ï–ñ–ï–ù','–û–ì–ù–ï–ù','–û–ö–û–õ–û',
  '–û–°–¢–™–†','–ü–ê–†–ß–ï','–ü–ï–í–ï–¶','–ü–ï–¢–ï–õ','–ü–û–õ–ï–¢','–ü–û–¢–û–ö','–ü–†–ê–í–û','–ü–ß–ï–õ–ê','–†–ê–ú–ö–ê','–†–ï–ñ–ò–ú',
  '–†–ò–ë–ê–†','–†–û–ö–õ–Ø','–†–û–ú–ê–ù','–°–ï–ó–û–ù','–°–ö–ê–õ–ê','–°–õ–ê–ù–ê','–°–û–õ–ï–ù','–°–û–ß–ï–ù','–°–†–ï–î–ê','–°–¢–ï–ù–ê',
  '–°–•–ï–ú–ê','–¢–ò–ö–í–ê','–¢–†–™–ë–ê','–¢–™–ú–ù–û','–§–ò–ù–ê–õ','–§–û–†–ú–ê','–•–†–ê–ù–ê','–•–£–ë–ê–í','–¶–í–ï–¢–ï','–¶–ï–õ–¢–ê',
  '–ß–ê–ù–¢–ê','–ß–ï–†–ï–ù','–®–ö–û–õ–ê','–ñ–ò–í–û–¢','–ì–õ–ê–í–ê','–ì–û–†–ï–ù','–î–™–°–ö–ê','–í–û–ô–ù–ê','–ë–ï–õ–ï–ì','–ö–û–ó–ï–õ',
  '–ö–£–ü–û–õ','–õ–Æ–õ–Ø–ö','–õ–û–í–ï–¶','–ú–û–ì–™–©','–ö–ê–ú–™–ö','–î–í–ê–ú–ê','–ù–û–©–ï–ù','–ü–ï–ß–ê–õ','–î–í–ï–†–ò','–ü–†–ê–ì–ê',
  '–ë–õ–ê–¢–û','–ë–†–û–î–ê','–í–Ø–¢–™–†','–ì–ê–†–í–ê–ù','–î–ï–ë–ï–õ','–ó–ï–ú–ï–ù','–ò–ó–¢–û–ö','–ö–õ–ê–î–ê','–õ–ê–ù–ï–¶','–ù–ê–†–û–î',
  '–û–ë–†–ï–î','–ü–õ–ê–•–ê','–†–ê–ó–í–û–î','–°–Ø–ù–ö–ê','–¢–™–ú–ï–ù','–£–°–ü–ï–•','–•–õ–Ø–ë–ê','–¶–ò–¢–ê–¢','–ß–ê–õ–ì–ê','–®–£–ú–ï–ù'
].filter(w=>w.length===5);

const KEYBOARD_ROWS = [
  ['–Ø','–í','–ï','–†','–¢','–™','–£','–ò','–û','–ü'],
  ['–ê','–°','–î','–§','–ì','–•','–ô','–ö','–õ'],
  ['ENTER','–ó','–¨','–¶','–ñ','–ë','–ù','–ú','‚å´']
];

let target, guesses, current, over;
const keyState = {};

function newGame() {
  target = WORDS[Math.floor(Math.random()*WORDS.length)];
  guesses = []; current = ''; over = false;
  Object.keys(keyState).forEach(k=>delete keyState[k]);
  document.getElementById('msg').textContent = '';
  buildGrid(); buildKeyboard();
}

function buildGrid() {
  const el = document.getElementById('grid');
  el.innerHTML = '';
  for (let r=0;r<6;r++){
    const row = document.createElement('div');
    row.className='row'; row.id='row'+r;
    for (let c=0;c<5;c++){
      const tile=document.createElement('div');
      tile.className='tile'; tile.id='tile'+r+'_'+c;
      row.appendChild(tile);
    }
    el.appendChild(row);
  }
  render();
}

function buildKeyboard() {
  const el = document.getElementById('keyboard');
  el.innerHTML = '';
  KEYBOARD_ROWS.forEach(row=>{
    const div=document.createElement('div');
    div.className='kb-row';
    row.forEach(k=>{
      const btn=document.createElement('div');
      btn.className='key'+(k.length>1?' wide':'');
      btn.textContent=k; btn.dataset.key=k;
      btn.onclick=()=>handleKey(k);
      if(keyState[k]) btn.classList.add(keyState[k]);
      el.appendChild(btn);
    });
    el.appendChild(div);
  });
}

function render() {
  for (let r=0;r<6;r++){
    const guess = guesses[r]||'';
    const isCurrent = r===guesses.length && !over;
    for (let c=0;c<5;c++){
      const tile=document.getElementById('tile'+r+'_'+c);
      if (!tile) continue;
      tile.className='tile';
      if (r<guesses.length){
        // evaluated
        tile.textContent=guesses[r][c]||'';
        tile.classList.add(evalGuess(guesses[r])[c]);
        tile.classList.add('filled');
      } else if (isCurrent){
        tile.textContent=current[c]||'';
        if(current[c]) tile.classList.add('filled');
      } else {
        tile.textContent='';
      }
    }
  }
}

function evalGuess(guess) {
  const result=Array(5).fill('absent');
  const targetArr=[...target];
  const used=Array(5).fill(false);
  // correct
  for(let i=0;i<5;i++) if(guess[i]===targetArr[i]){result[i]='correct';used[i]=true;}
  // present
  for(let i=0;i<5;i++){
    if(result[i]==='correct') continue;
    for(let j=0;j<5;j++){
      if(!used[j]&&guess[i]===targetArr[j]){result[i]='present';used[j]=true;break;}
    }
  }
  return result;
}

function updateKeyboard(guess) {
  const res=evalGuess(guess);
  const PRIORITY={correct:3,present:2,absent:1};
  guess.split('').forEach((ch,i)=>{
    const prev=PRIORITY[keyState[ch]]||0;
    if((PRIORITY[res[i]]||0)>prev) keyState[ch]=res[i];
  });
  buildKeyboard();
}

function handleKey(k) {
  if(over) return;
  if(k==='‚å´'||k==='Backspace'){current=current.slice(0,-1);}
  else if(k==='ENTER'||k==='Enter'){submit();}
  else if(current.length<5&&k.length===1){current+=k.toUpperCase();}
  render();
}

function submit() {
  if(current.length<5){document.getElementById('msg').textContent='–í—ä–≤–µ–¥–∏ 5 –±—É–∫–≤–∏';return;}
  if(!WORDS.includes(current)){document.getElementById('msg').textContent='–î—É–º–∞—Ç–∞ –Ω–µ –µ –≤ —Å–ø–∏—Å—ä–∫–∞';return;}
  guesses.push(current);
  updateKeyboard(current);
  render();
  if(current===target){
    over=true;
    const msgs=['–û—Ç–ª–∏—á–Ω–æ!','–°—Ç—Ä–∞—Ö–æ—Ç–Ω–æ!','–ë—Ä–∞–≤–æ!','–î–æ–±—Ä–µ!','–£—Å–ø—è!','–§—É, –µ–¥–≤–∞!'];
    document.getElementById('msg').textContent=msgs[guesses.length-1]||'–ë—Ä–∞–≤–æ!';
    return;
  }
  current='';
  if(guesses.length===6){
    over=true;
    document.getElementById('msg').textContent='–î—É–º–∞—Ç–∞ –±–µ—à–µ: '+target;
  } else {
    document.getElementById('msg').textContent='';
  }
}

document.addEventListener('keydown',e=>{
  if(e.ctrlKey||e.altKey||e.metaKey) return;
  if(e.key==='Backspace') handleKey('‚å´');
  else if(e.key==='Enter') handleKey('ENTER');
  else if(e.key.length===1) handleKey(e.key.toUpperCase());
});
document.getElementById('newBtn').onclick=newGame;
newGame();
</script>
</body>
</html>
